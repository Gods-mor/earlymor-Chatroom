# 开发文档（三）

## 好友聊天遇到的问题：

1、~~要进入聊天选项两次才能输入聊天消息（解决）~~

~~**2、对好友的在线聊天不能显示消息**~~

3、~~未读消息没完成（解决）~~

4、~~好友列表有一次操作延迟(解决)~~

5、~~聊天信息存储的发送者账号错误(解决)~~

6、~~chatstatus状态清除（解决）~~

7、~~requestType == FRIEND_TYPE~~
~~friendType:4~~
~~chat with friend~~
~~Json parse error :bad optional access~~
~~m_writebufClient/1.1 400 Bad Request（解决）~~

**8、聊天时创建了一个空账号（不明）**

9、删除好友后仍显示好友

~~10、转发消息时和上条消息一起发送~~

11、onlinenumber没用到后期可以考虑加上

12、userfriend好像也没怎么用上

13、粘包问题也要解决

14、不能加自己为好友

## 计划：

**1.完成未读消息计数**

​	什么情况下消息已读：

​		好友进入聊天界面，拉取未读消息并清空未读消息计数（有点问题）

​		拉取未读消息，即服务器对比将最近的（队列尾）n条消息，发送到客户端，客户端按照格式显示

  ~~好友向用户发送一条消息，用户不在对应的聊天界面，未读消息计数加一（解决）~~

~~2.实时聊天在线显示，消息发送~~

​		~~主要在服务器转发消息，是通过TcpConnection还是直接send,客户端接收线程，显示消息~~

​		~~消息格式：好友名（账号）时间：换行~~

​						~~「data」~~

3.拉黑好友

​		维护一张表，内容是拉黑好友列表，如果好友被拉黑就不接收该好友的消息

~~4.登录的bug修一下~~

​		~~删除cin.get(),好像是因为这个才注册了一个空账号，并不是因为这个，原因还在找~~		

5.密码加密

​		chatGPT1

~~6.删除好友，双方都要删除~~

~~7.返回上一级~~

8.拉黑好友

9.实时通知

~~10.退出聊天“:q”特殊处理~~

11.注销

12、缓冲区的清空问题