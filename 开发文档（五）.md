# 开发文档（五）

目前还需要写的功能：

### 	~~4、好友聊天历史记录~~

:h 拉取所有的聊天记录，通过服务器传递数据

### 	~~10、群聊的聊天记录~~

​				:h 拉取所有的聊天记录，通过服务器传递数据，暂时只打印账号，用户名查询有点麻烦

#### 				问题：权限更新不及时，设为管理员后该用户仍显示为成员

### 	~~5、群聊解散~~

​		需要释放的内容：

​				成员的group表（hash）account+"_Group" 将群聊id对应消息清除

​				管理员的group表（hash）account+"_Group" 将群聊id对应消息清除

​				群组hash表(hasg)  "Group_"+id

​				群组成员表(set)      id+"_Member"

​				群组管理员表(set)   id+"_Administrator"

​				群组聊天表(list) 	  id+"_Chat"

​				群组通知表(list)       id + "_Group_Notice"

​				群主的group表（hash）account+"_Group" 将群聊id对应消息清除

#### 问题：解散后成员应收到消息，并且在群中的应该不能在进行相关操作，立刻退出群功能页面

### 	~~9、踢人（群主/管理员）~~

需要实时通知，把成员从成员表中移除，

该成员的群组表删除该群聊成员的group表（hash）account+"_Group" 将群聊id对应消息清除

群组成员表(set)      id+"_Member"，或群组管理员表(set)   id+"_Administrator"

注意管理员不能踢群主，即只能踢权限比自己低的

### 	~~6、用户的群组列表~~

从哈希表中遍历得到

群聊消息列表（list）id+"_Chat"

### 	~~7、成员退出群聊~~

成员的group表（hash）account+"_Group" 将群聊id对应消息清除_

_群组成员表(set)      id+"_Member"

### 	~~8、管理员批准用户加入~~

### ~~15、查看成员列表~~

owner "Group_"+id

admin 群组管理员表(set)   id+"_Administrator"

member 群组成员表(set)      id+"_Member"

### 	12、在线发送文件

#### 	私聊：

​				在聊天中输入：f，选择发送文件，使用相对路径，先发送文件名

​				服务器收到后，发回一个确认请求，接着根据好友账号创建文件夹，将文件接收到拼接好的路径

​				客户端发送文件，

​				发送文件需要得到文件描述符fd,以二进制的格式，使用sendfile,		

​				发送文件后好友应该得到提示，且应该在聊天记录中查到

​				~~存储：私聊存放在文件夹Friend_account1+account2下~~

​				接收：输入：r,选择接收的文件,先查看是否有聊天文件夹，没有则提示无文件，有则提示输入，从服务器接受文件

​				服务器 <------发送请求-------客户端

​							-------得到文件列表------>

​							<-------请求接收文件名---

​							-------文件大小------------>

​							-------->文件------------->

​				接收文件有点问题，有时会把回应写进文件里

#### 	群聊：

​				~~存储：私聊存放在文件夹Group_groupid下~~

​				接收：输入：r,选择接收的文件

### 	13、非法输入

1. 字符输入在数字预期的情况
2.  
3.  
4.  
5.  
6. 


### 	2、好友添加申请实时通知

### 	11、实现在线用户对离线用户发送消息，离线用户上线后获得通知（群聊+私聊）

### 	3、拉黑好友

### 1、账号注销或退出登录

### 	

### 	14、心跳

